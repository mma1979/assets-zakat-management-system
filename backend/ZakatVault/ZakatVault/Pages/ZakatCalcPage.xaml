<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ZakatVault.Pages.ZakatCalcPage"
             Title="Calculator"
             BackgroundColor="#F5F7FA">
    <ScrollView>
        <VerticalStackLayout Spacing="24" Padding="24">
            
            <!-- Header -->
            <Label Text="Zakat Calculator" FontSize="20" FontAttributes="Bold" TextColor="{DynamicResource MidnightBlue}" HorizontalOptions="Center" />

            <!-- Due Date Card -->
            <Border BackgroundColor="White" StrokeThickness="0" StrokeShape="RoundRectangle 20" Padding="24" Shadow="{Shadow Brush=Black, Offset='0,4', Radius=10, Opacity=0.05}">
                <VerticalStackLayout Spacing="20">
                    <Grid ColumnDefinitions="Auto, *, Auto">
                        <Border  StrokeShape="RoundRectangle 12" HeightRequest="48" WidthRequest="48" Padding="0" StrokeThickness="0">
                            <Image Source="icon_calendar.png" Aspect="AspectFit" HorizontalOptions="Center" VerticalOptions="Center"/>
                        </Border>
                        
                        <VerticalStackLayout Grid.Column="1" Margin="16,0,0,0" VerticalOptions="Center" Spacing="2">
                            <Label Text="Zakat Due Date" FontAttributes="Bold" TextColor="{DynamicResource MidnightBlue}" FontSize="16"/>
                            <Label Text="Lunar Year Cycle" TextColor="{DynamicResource Gray500}" FontSize="13"/>
                        </VerticalStackLayout>
                        
                        <Button Grid.Column="2" FontFamily="OpenSansRegular" FontSize="18" BackgroundColor="#F0FDF4" TextColor="{DynamicResource BrandGreen}" WidthRequest="44" HeightRequest="44" CornerRadius="12" Padding="0" ImageSource="icon_bell.png"/>
                    </Grid>
                    
                    <Border Stroke="#E2E8F0" StrokeThickness="1" StrokeShape="RoundRectangle 12" Padding="0" BackgroundColor="#FAFAFA">
                        <Grid ColumnDefinitions="*, Auto, *">
                            <HorizontalStackLayout Grid.Column="0" Spacing="10" Padding="16,12" VerticalOptions="Center">
                                <Image  Source="icon_day.png" WidthRequest="35"/>
                                <Label Text="{Binding Result.DueDate, StringFormat='{0:dd MMM yyyy}'}" TextColor="{DynamicResource MidnightBlue}" FontSize="14"/>
                            </HorizontalStackLayout>
                            
                            <BoxView Grid.Column="1" WidthRequest="1" Color="#E2E8F0" VerticalOptions="Fill"/>

                            <VerticalStackLayout Grid.Column="2" Padding="16,12" Spacing="2" HorizontalOptions="Center">
                                <Label Text="{Binding Result.DaysRemaining, StringFormat='{0} Days Left'}" TextColor="{DynamicResource BrandGreen}" FontAttributes="Bold" FontSize="11" HorizontalOptions="Center"/>
                                <Label Text="{Binding Result.HijriDueDate}" TextColor="{DynamicResource Gray600}" FontSize="11" HorizontalOptions="Center"/>
                            </VerticalStackLayout>
                        </Grid>
                    </Border>
                </VerticalStackLayout>
            </Border>

            <!-- Total Zakat Due Card -->
            <Border StrokeThickness="0" StrokeShape="RoundRectangle 24" Padding="32" Shadow="{Shadow Brush={DynamicResource BrandGreen}, Offset='0,10', Radius=20, Opacity=0.2}">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="{DynamicResource BrandGreen}" Offset="0.0" />
                        <GradientStop Color="#004D40" Offset="1.0" />
                    </LinearGradientBrush>
                </Border.Background>
                <VerticalStackLayout Spacing="16" HorizontalOptions="Center">
                    <Border BackgroundColor="#20FFFFFF" Padding="0" StrokeShape="RoundRectangle 30" HorizontalOptions="Center" HeightRequest="60" WidthRequest="60" StrokeThickness="0">
                        <Label Text="✔" TextColor="White" FontSize="26" HorizontalOptions="Center" VerticalOptions="Center"/>
                    </Border>
                    
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Total Due" TextColor="#CCFFFFFF" FontSize="14" HorizontalOptions="Center"/>
                        <Label Text="{Binding Result.TotalZakatDue, StringFormat='{0:N2}'}" TextColor="White" FontAttributes="Bold" FontSize="36" HorizontalOptions="Center"/>
                        <Label Text="EGP" TextColor="#CCFFFFFF" FontSize="14" HorizontalOptions="Center" FontAttributes="Bold" Margin="0,-4,0,0"/>
                    </VerticalStackLayout>
                    
                    <Label Text="Payable immediately" TextColor="#E0F2F1" FontSize="13" HorizontalOptions="Center" Opacity="0.9"/>
                </VerticalStackLayout>
            </Border>

            <Grid ColumnDefinitions="*, *" ColumnSpacing="16">
                <!-- Calculation Details -->
                <Border Grid.Column="0" BackgroundColor="White" StrokeThickness="0" StrokeShape="RoundRectangle 20" Padding="20" Shadow="{Shadow Brush=Black, Offset='0,2', Radius=8, Opacity=0.03}">
                    <VerticalStackLayout Spacing="16">
                        <Label Text="Breakdown" FontAttributes="Bold" TextColor="{DynamicResource MidnightBlue}" FontSize="15"/>

                        <!-- Total Assets -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Total Assets" TextColor="{DynamicResource Gray500}" FontSize="12"/>
                            <Label Text="{Binding Result.TotalAssets, StringFormat='{0:N0}'}" TextColor="{DynamicResource BrandGreen}" FontAttributes="Bold" FontSize="16"/>
                        </VerticalStackLayout>
                        
                        <BoxView HeightRequest="1" Color="#F1F5F9"/>

                        <!-- Liabilities -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Liabilities" TextColor="{DynamicResource Gray500}" FontSize="12"/>
                            <Label Text="{Binding Result.DeductibleLiabilities, StringFormat='-{0:N0}'}" TextColor="#EF4444" FontAttributes="Bold" FontSize="16"/>
                        </VerticalStackLayout>

                        <BoxView HeightRequest="1" Color="#F1F5F9"/>

                        <!-- Net Zakat Base -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Net Base" TextColor="{DynamicResource Gray500}" FontSize="12"/>
                            <Label Text="{Binding Result.NetZakatBase, StringFormat='{0:N0}'}" TextColor="#0F172A" FontAttributes="Bold" FontSize="16"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Border>

                <!-- Nisab Thresholds -->
                <Border Grid.Column="1" BackgroundColor="White" StrokeThickness="0" StrokeShape="RoundRectangle 20" Padding="20" Shadow="{Shadow Brush=Black, Offset='0,2', Radius=8, Opacity=0.03}">
                     <VerticalStackLayout Spacing="16">
                        <Label Text="Thresholds" FontAttributes="Bold" TextColor="{DynamicResource MidnightBlue}" FontSize="15"/>

                        <!-- Gold Nisab -->
                        <Border BackgroundColor="#FFFBEB" StrokeThickness="0" StrokeShape="RoundRectangle 12" Padding="12">
                            <VerticalStackLayout Spacing="4">
                                <Label Text="Gold (85g)" TextColor="#B45309" FontSize="11" FontAttributes="Bold"/>
                                <Label Text="{Binding Result.GoldNisab.ThresholdValue, StringFormat='{0:N0}'}" TextColor="#78350F" FontAttributes="Bold" FontSize="15"/>
                            </VerticalStackLayout>
                        </Border>

                        <!-- Silver Nisab -->
                        <Border BackgroundColor="#F8FAFC" StrokeThickness="0" StrokeShape="RoundRectangle 12" Padding="12">
                            <VerticalStackLayout Spacing="4">
                                <Label Text="Silver (595g)" TextColor="{DynamicResource Gray500}" FontSize="11" FontAttributes="Bold"/>
                                <Label Text="{Binding Result.SilverNisab.ThresholdValue, StringFormat='{0:N0}'}" TextColor="{DynamicResource Gray700}" FontAttributes="Bold" FontSize="15"/>
                            </VerticalStackLayout>
                        </Border>
                    </VerticalStackLayout>
                </Border>
            </Grid>

            <BoxView HeightRequest="80"/>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
